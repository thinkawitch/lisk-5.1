<!-- BEGIN list -->
<script language="javascript">
<!--
function jump (index, position) {
    var sort_list = document.sort_form.sort_list;
    var length    = sort_list.options.length;
	if (index>=0 && index<length && position>=0 && position<length && index!=position) {
		direction = (position - index) / Math.abs(position - index);
		temp_text   = sort_list.options[index].text;
		temp_value  = sort_list.options[index].value;
		for (i = 0; i<Math.abs(index - position); i++) {
			sort_list.options[index + direction * i].text   = sort_list.options[index + direction * (i + 1)].text;
			sort_list.options[index + direction * i].value  = sort_list.options[index + direction * (i + 1)].value;
		}
		sort_list.options[position].text = temp_text;
		sort_list.options[position].value = temp_value;
		sort_list.selectedIndex = position;
	}
}

function SortStrCompareAsc(a, b) {
	  if ( a.name.toLowerCase() < b.name.toLowerCase() ) return -1;
	  if ( a.name.toLowerCase() > b.name.toLowerCase() ) return 1;
	  return 0;
}

function SortSelectAlphabetically() {
	var ids = new Array;
	var list = document.sort_form.sort_list;
	for (var i=0; i<list.options.length; i++) {
		ids[i] = { id: list.options[i].value, name: list.options[i].text };
	}
	ids.sort(SortStrCompareAsc);
	list.options.length=0;
	for(var i=0; i<ids.length; i++) {
		list.options[i] = new Option(ids[i].name, ids[i].id);
	}
}

//-->
</script>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <form name="sort_form" method="post">
    <tr> 
      <td width="400" align="right" class="TDForm"><table width="100%" border="0" cellspacing="0" cellpadding="5">
          <tr> 
            <td align="right" valign="middle"><select size="10" name="sort_list" style="width:250px;">
                <!-- BEGIN list_row -->
                <option value="{ID}">{NAME}</option>

                <!-- END list_row -->
              </select></td>
          </tr>
        </table></td>
      <td class="TDForm"><a href="#" liskHint="Make the selected recrod the first in the list" onClick="jump(document.sort_form.sort_list.selectedIndex, 0);"><img src="img/cms/order/b_mekefirst.gif" width="93" height="23" border="0"></a><br> 
        <a href="#" liskHint="Move the selected record one position up." onClick="jump(document.sort_form.sort_list.selectedIndex, document.sort_form.sort_list.selectedIndex - 1);"><img src="img/cms/order/b_up.gif" width="93" height="23" vspace="2" border="0"></a><br>
        <br>
        <a href="#" liskHint="Move the selected record one position down." onClick="jump(document.sort_form.sort_list.selectedIndex, document.sort_form.sort_list.selectedIndex + 1);"><img src="img/cms/order/b_down.gif" width="93" height="23" vspace="2" border="0"></a> 
        <br> 
        <a href="#" liskHint="Make the selected record the last in the list." onClick="jump(document.sort_form.sort_list.selectedIndex, document.sort_form.sort_list.options.length - 1);"><img src="img/cms/order/b_makelast.gif" width="93" height="23" border="0"></a>
        <br> <br />
        <a href="javascript: SortSelectAlphabetically();"><img src="img/cms/order/sort_a_z.gif" width="102" height="23" border="0" /></a></td>

    </tr>
    <tr> 
      <td width="400" align="right" class="TDFormFooter" style="padding-right: 30px;"><input type=hidden name=id_set> 
        <input name="action" type="hidden" id="action" value="submit" vspace=""> 
        <a href="#" liskHint="Reset the records order to the initial." onClick="for (i=0; i<document.sort_form.sort_list.options.length; i++) {&#13;&#10;document.sort_form.sort_list.options[i].text = temp_texts[i];&#13;&#10;document.sort_form.sort_list.options[i].value = temp_values[i];&#13;&#10;};"><img src="img/cms/order/b_reset.gif" width="93" height="23" border="0"></a> 
        <a href="#" liskHint="Save new records order." onClick="document.sort_form.id_set.value = '';&#13;&#10;for (i=0; i<document.sort_form.sort_list.options.length; i++)&#13;&#10;document.sort_form.id_set.value = document.sort_form.id_set.value + document.sort_form.sort_list.options[i].value + ',';&#13;&#10;document.sort_form.submit();"><img src="img/cms/order/b_save.gif" width="93" height="23" border="0"></a></td>
      <td class="TDFormFooter">&nbsp;</td>
    </tr>
  </form>
</table>
<script language=javascript>
<!--
var options = document.sort_form.sort_list.options;
var temp_texts  = new Array(options.length);
var temp_values = new Array(options.length);
var length      = options.length;
for (i=0; i<length; i++) {
	temp_texts[i] = options[i].text;
	temp_values[i] = options[i].value;
}
//-->
</script>

<!-- END list -->
